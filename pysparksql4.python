{"version":"NotebookV1","origId":3679374721958241,"name":"pysparksql4","language":"python","commands":[{"version":"CommandV1","origId":29846222050506,"guid":"3ee085f9-70b5-4060-b57d-3494fc70241b","subtype":"command","commandType":"auto","position":7.0,"command":"%sql\nSELECT * FROM funcionarios RIGHT OUTER JOIN localizacoes ON funcionarios.id = localizacoes.id","commandVersion":6,"state":"finished","results":{"type":"table","data":[[1,"Anderson",10000,1,"Delhi","India"],[2,"Kenedy",20000,2,"Tamil nadu","India"],[3,"Billy",23000,3,"London","UK"],[4,"Andy",23000,4,"Sydney","Australia"],[8,"Keyth",18000,8,"New York","USA"],[9,"Truman",21000,9,"California","USA"],[null,null,null,10,"New Jersey","USA"],[null,null,null,11,"Texas","USA"],[null,null,null,12,"Chicago","USA"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"long\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"local","type":"\"string\"","metadata":"{}"},{"name":"pais","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635528622518,"submitTime":1635528622490,"finishTime":1635528623322,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"671","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1ce1190b-3e6c-4ed0-8f10-ffb8ae3decb4"},{"version":"CommandV1","origId":29846222050507,"guid":"4340990f-41b0-4012-85a3-22bbdb7f377f","subtype":"command","commandType":"auto","position":8.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"70b32523-bcd4-4f21-b8cb-6928b6113fac"},{"version":"CommandV1","origId":3679374721958242,"guid":"960ed800-7fd5-46a9-8a44-a730c1299b41","subtype":"command","commandType":"auto","position":1.0,"command":"import pyspark.sql.functions as F","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635527815584,"submitTime":1635527815572,"finishTime":1635527815623,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3b55f079-1b6a-4add-ad59-42997f524585"},{"version":"CommandV1","origId":3679374721958243,"guid":"eaf4a0f6-b667-445f-8ace-888a43a65615","subtype":"command","commandType":"auto","position":2.0,"command":"dados1 = [\n    (1, \"Anderson\", 10000),\n    (2, \"Kenedy\", 20000),\n    (3, \"Billy\", 23000),\n    (4, \"Andy\", 23000),\n    (5, \"Mary\", 24000),\n    (6, \"Eduardo\", 19000),\n    (7, \"Mendes\", 15000),\n    (8, \"Keyth\", 18000),\n    (9, \"Truman\", 21000),\n]\n\nschema1= [\"id\", \"nome\", \"salario\"]\nspark.createDataFrame(data= dados1, schema=schema1).createOrReplaceTempView('funcionarios')","commandVersion":46,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635528151679,"submitTime":1635528151666,"finishTime":1635528152045,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1eec66b5-4290-43b0-a50f-15759fc11cde"},{"version":"CommandV1","origId":3679374721958244,"guid":"3493d329-bd19-427f-a6c7-fdc84a7a245f","subtype":"command","commandType":"auto","position":3.0,"command":"dados2 = [\n    (1, \"Delhi\", \"India\"),\n    (2, \"Tamil nadu\", \"India\"),\n    (3, \"London\", \"UK\"),\n    (4, \"Sydney\", \"Australia\"),\n    (8, \"New York\", \"USA\"),\n    (9, \"California\", \"USA\"),\n    (10, \"New Jersey\", \"USA\"),\n    (11, \"Texas\", \"USA\"),\n    (12, \"Chicago\", \"USA\"),\n]\n\nschema2 = [\"id\", \"local\", \"pais\"]\nspark.createDataFrame(data= dados2, schema=schema2).createOrReplaceTempView('localizacoes')","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635528376110,"submitTime":1635528376093,"finishTime":1635528376240,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0dc996a3-00f6-41bc-a23c-c3810d3b712e"},{"version":"CommandV1","origId":3679374721958245,"guid":"13e3ef19-31b5-4456-881a-07a427b9f728","subtype":"command","commandType":"auto","position":4.0,"command":"#SELECT campos FROM tabela1 INNER JOIN tabela2 ON tabela1.coluna = tabela2.coluna","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635528272910,"submitTime":1635528272897,"finishTime":1635528272953,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2337cc07-3de2-44bf-92a9-f30455842173"},{"version":"CommandV1","origId":3679374721958246,"guid":"f138e1c9-420f-4377-90d2-528ad9f20617","subtype":"command","commandType":"auto","position":5.0,"command":"%sql\nSELECT * FROM funcionarios INNER JOIN localizacoes ON funcionarios.id = localizacoes.id","commandVersion":27,"state":"finished","results":{"type":"table","data":[[1,"Anderson",10000,1,"Delhi","India"],[2,"Kenedy",20000,2,"Tamil nadu","India"],[3,"Billy",23000,3,"London","UK"],[4,"Andy",23000,4,"Sydney","Australia"],[8,"Keyth",18000,8,"New York","USA"],[9,"Truman",21000,9,"California","USA"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"long\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"local","type":"\"string\"","metadata":"{}"},{"name":"pais","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635528379740,"submitTime":1635528379728,"finishTime":1635528380652,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"959.973","height":"362.986","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e90af3ac-5a31-4715-a9a1-4f0cdcbab4cc"},{"version":"CommandV1","origId":3679374721958247,"guid":"fdd06fe7-a202-445d-8ad7-af9c000b6307","subtype":"command","commandType":"auto","position":6.0,"command":"%sql\nSELECT * FROM funcionarios LEFT OUTER JOIN localizacoes ON funcionarios.id = localizacoes.id","commandVersion":7,"state":"finished","results":{"type":"table","data":[[1,"Anderson",10000,1,"Delhi","India"],[2,"Kenedy",20000,2,"Tamil nadu","India"],[3,"Billy",23000,3,"London","UK"],[4,"Andy",23000,4,"Sydney","Australia"],[5,"Mary",24000,null,null,null],[6,"Eduardo",19000,null,null,null],[7,"Mendes",15000,null,null,null],[8,"Keyth",18000,8,"New York","USA"],[9,"Truman",21000,9,"California","USA"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"long\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"local","type":"\"string\"","metadata":"{}"},{"name":"pais","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635528611694,"submitTime":1635528611418,"finishTime":1635528612933,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"671","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"91756493-469d-4f9d-9171-eafd812a8763"}],"dashboards":[],"guid":"b256dd4b-a9eb-43b0-8a29-cc832fd75d72","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}