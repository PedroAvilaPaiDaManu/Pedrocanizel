{"version":"NotebookV1","origId":2708467603873639,"name":"pyspark_join","language":"python","commands":[{"version":"CommandV1","origId":1053087902779284,"guid":"76f2b7b4-a531-4cdd-8d5b-f59067195a19","subtype":"command","commandType":"auto","position":2.0,"command":"dados = [\n          (1, 'Andereson', 1000.00),\n          (2, 'Kennedy', 2000.00),\n          (3, 'Bruno', 2300.00),\n          (4, 'Maria', 2300.00),\n          (5, 'Eduardo', 2400.00),\n          (6, 'Mendes', 1900.00),\n          (7, 'Kethlyn', 1500.00),\n          (8, 'Thiago', 1800.00),\n          (9, 'Carla', 2100.00)\n]\n\n\nschema = [\"id\", \"nome\", \"salario\"]\n\ndf1 = spark.createDataFrame(data=dados, schema=schema)\ndf1.printSchema()\ndf1.show()\ndisplay(df1)","commandVersion":36,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- id: long (nullable = true)\n |-- nome: string (nullable = true)\n |-- salario: double (nullable = true)\n\n+---+---------+-------+\n| id|     nome|salario|\n+---+---------+-------+\n|  1|Andereson| 1000.0|\n|  2|  Kennedy| 2000.0|\n|  3|    Bruno| 2300.0|\n|  4|    Maria| 2300.0|\n|  5|  Eduardo| 2400.0|\n|  6|   Mendes| 1900.0|\n|  7|  Kethlyn| 1500.0|\n|  8|   Thiago| 1800.0|\n|  9|    Carla| 2100.0|\n+---+---------+-------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},{"type":"table","data":[[1,"Andereson",1000.0],[2,"Kennedy",2000.0],[3,"Bruno",2300.0],[4,"Maria",2300.0],[5,"Eduardo",2400.0],[6,"Mendes",1900.0],[7,"Kethlyn",1500.0],[8,"Thiago",1800.0],[9,"Carla",2100.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635443542491,"submitTime":1635443542477,"finishTime":1635443543251,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"371","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"56f8d99b-45f8-46b7-8e90-f2fb669a1352"},{"version":"CommandV1","origId":1053087902779285,"guid":"b7f83f9f-e081-4324-af7c-a5e1ad873626","subtype":"command","commandType":"auto","position":3.0,"command":"dados2 = [\n    (1, \"Delhi\", \"India\"),\n    (2, \"Tamil Nadu\", \"India\"),\n    (3, \"London\", \"UK\"),\n    (4, \"Sydney\", \"Australia\"),\n    (8, \"New York\", \"USA\"),\n    (9, \"California\", \"USA\"),\n    (10, \"New Jersey\", \"USA\"),\n    (11, \"Texas\", \"USA\"),\n    (12, \"Chicago\", \"USA\")\n]\nschema2 = [\"id\", \"local\", \"pais\"]\n\ndf2 = spark.createDataFrame(data=dados2, schema=schema2)\ndf2.printSchema()\ndf2.show()\ndisplay(df2)","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- id: long (nullable = true)\n |-- local: string (nullable = true)\n |-- pais: string (nullable = true)\n\n+---+----------+---------+\n| id|     local|     pais|\n+---+----------+---------+\n|  1|     Delhi|    India|\n|  2|Tamil Nadu|    India|\n|  3|    London|       UK|\n|  4|    Sydney|Australia|\n|  8|  New York|      USA|\n|  9|California|      USA|\n| 10|New Jersey|      USA|\n| 11|     Texas|      USA|\n| 12|   Chicago|      USA|\n+---+----------+---------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},{"type":"table","data":[[1,"Delhi","India"],[2,"Tamil Nadu","India"],[3,"London","UK"],[4,"Sydney","Australia"],[8,"New York","USA"],[9,"California","USA"],[10,"New Jersey","USA"],[11,"Texas","USA"],[12,"Chicago","USA"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"local","type":"\"string\"","metadata":"{}"},{"name":"pais","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df2","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"local","nullable":true,"type":"string"},{"metadata":{},"name":"pais","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635443536256,"submitTime":1635443536241,"finishTime":1635443537109,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"371","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"795b9e08-53e1-4b6e-b141-3310914ec376"},{"version":"CommandV1","origId":1053087902779286,"guid":"b7579d03-3f06-41a9-a578-44f489839259","subtype":"command","commandType":"auto","position":4.0,"command":"df1.display()\ndf2.display()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,"Andereson",1000.0],[2,"Kennedy",2000.0],[3,"Bruno",2300.0],[4,"Maria",2300.0],[5,"Eduardo",2400.0],[6,"Mendes",1900.0],[7,"Kethlyn",1500.0],[8,"Thiago",1800.0],[9,"Carla",2100.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},{"type":"table","data":[[1,"Delhi","India"],[2,"Tamil Nadu","India"],[3,"London","UK"],[4,"Sydney","Australia"],[8,"New York","USA"],[9,"California","USA"],[10,"New Jersey","USA"],[11,"Texas","USA"],[12,"Chicago","USA"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"local","type":"\"string\"","metadata":"{}"},{"name":"pais","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635443836469,"submitTime":1635443836453,"finishTime":1635443837034,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"378.982","height":"298.582","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8758412d-5bbf-4c2b-9d4c-2eb03bb0249b"},{"version":"CommandV1","origId":1053087902779287,"guid":"23365e9f-e8e3-4804-8329-bddd4e363db1","subtype":"command","commandType":"auto","position":5.0,"command":"#Ele verifica algum campo em comum nos dois dataframes e retorna os resultados\ndf_inner = df1.join(df2, on=['id'], how='inner')\ndf_inner.show()","commandVersion":39,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+---------+-------+----------+---------+\n| id|     nome|salario|     local|     pais|\n+---+---------+-------+----------+---------+\n|  1|Andereson| 1000.0|     Delhi|    India|\n|  2|  Kennedy| 2000.0|Tamil Nadu|    India|\n|  3|    Bruno| 2300.0|    London|       UK|\n|  4|    Maria| 2300.0|    Sydney|Australia|\n|  8|   Thiago| 1800.0|  New York|      USA|\n|  9|    Carla| 2100.0|California|      USA|\n+---+---------+-------+----------+---------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_inner","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"},{"metadata":{},"name":"local","nullable":true,"type":"string"},{"metadata":{},"name":"pais","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635444181456,"submitTime":1635444181433,"finishTime":1635444183746,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Inner Join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c51d5fbb-598c-4629-ac01-669c0efc2e00"},{"version":"CommandV1","origId":1053087902779288,"guid":"808da71c-d0cf-435f-aab0-4e19fd821239","subtype":"command","commandType":"auto","position":6.0,"command":"#RETORNA TODOS OS DADOS DO DATAFRAME DA COLUNA DA ESQUERDA E DA DIREITA\ndf_outer = df1.join(df2, on=['id'], how='outer')\ndf_outer.show()","commandVersion":30,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Outer join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1b5ba90-acd8-475d-8c09-51788e7d5780"},{"version":"CommandV1","origId":2708467603873640,"guid":"26d9f3cf-57f3-41fc-bc11-6fb0dd586455","subtype":"command","commandType":"auto","position":1.0,"command":"import pyspark.sql.functions as F\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, FloatType\nfrom pyspark.sql.functions import sum","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635443064306,"submitTime":1635443064150,"finishTime":1635443064375,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"58ccdc65-afac-4df1-bff6-9f97ec343633"},{"version":"CommandV1","origId":3590089513437088,"guid":"8edf8501-bb6d-4114-b1ae-bb6f74b36771","subtype":"command","commandType":"auto","position":7.0,"command":"#retorna todos os dados do df da coluna da esquerda e oss registro que fazem match\ndf_left = df1.join(df2, on=['id'], how='left')\ndf_left.show()","commandVersion":38,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+---------+-------+----------+---------+\n| id|     nome|salario|     local|     pais|\n+---+---------+-------+----------+---------+\n|  1|Andereson| 1000.0|     Delhi|    India|\n|  2|  Kennedy| 2000.0|Tamil Nadu|    India|\n|  3|    Bruno| 2300.0|    London|       UK|\n|  4|    Maria| 2300.0|    Sydney|Australia|\n|  5|  Eduardo| 2400.0|      null|     null|\n|  6|   Mendes| 1900.0|      null|     null|\n|  7|  Kethlyn| 1500.0|      null|     null|\n|  8|   Thiago| 1800.0|  New York|      USA|\n|  9|    Carla| 2100.0|California|      USA|\n+---+---------+-------+----------+---------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_left","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"},{"metadata":{},"name":"local","nullable":true,"type":"string"},{"metadata":{},"name":"pais","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635445793453,"submitTime":1635445793435,"finishTime":1635445794800,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Left Join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0373ab77-939f-4f46-a3f2-abd8260d5f95"},{"version":"CommandV1","origId":3590089513437089,"guid":"ef7347ae-a4ac-4965-9b19-4bc520fb0b54","subtype":"command","commandType":"auto","position":0.5,"command":"%md\nJOIN\nO Pyspark Join é usado para combinar dois DataFrames e, encadeando-os, você pode juntar vários DataFrames;\nEle suporta todas as operações básicas de tipo de junção disponíveis no SQL tradicional, como INNER< LEFT OUTER, RIGHT OUTER, LEFT ANTI, LEFT SEMI, CROSS, SELF JOIN.\n\nEXEMPLOS:\ninner ==> INNER JOIN SQL\nouter, full, fullouter, full_outer ==> FULL OUTER JOIN\nleft, leftouter, left_outer ==> LEFT JOIN\nright, rightouter, right_outer ==> RIGHT JOIN\ncross\nanti, leftanti, left_anti\nsemi, leftsemi, left_semi","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cedad203-8ea2-4e1a-8892-e7bcfaa14c3e"},{"version":"CommandV1","origId":3590089513437090,"guid":"a77a7aa9-ac1d-41b4-9825-2bce3c55510d","subtype":"command","commandType":"auto","position":8.0,"command":"#RETORNA TODOS OS DADOS DO DATAFRAME DA COLUNA DA DIREITA E OS REGISTROS QUE FAZEM MATCH\n\ndf_right = df1.join(df2, on=['id'], how='right')\ndf_right.display()","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,"Andereson",1000.0,"Delhi","India"],[2,"Kennedy",2000.0,"Tamil Nadu","India"],[3,"Bruno",2300.0,"London","UK"],[4,"Maria",2300.0,"Sydney","Australia"],[8,"Thiago",1800.0,"New York","USA"],[9,"Carla",2100.0,"California","USA"],[10,null,null,"New Jersey","USA"],[11,null,null,"Texas","USA"],[12,null,null,"Chicago","USA"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"},{"name":"local","type":"\"string\"","metadata":"{}"},{"name":"pais","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_right","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"},{"metadata":{},"name":"local","nullable":true,"type":"string"},{"metadata":{},"name":"pais","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635446268684,"submitTime":1635446268672,"finishTime":1635446269670,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"571","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Right join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"613fb4fc-aa92-49d8-822d-69e9730a1f17"},{"version":"CommandV1","origId":3590089513437091,"guid":"a12d407c-b7f1-44ac-abe3-39a2a17bcc70","subtype":"command","commandType":"auto","position":9.0,"command":"#retorna todos os dados do df da coluna da esquerda e que nao estao no df da dirieta\ndf_left_anti = df1.join(df2, on=['id'], how='left_anti')\ndf_left_anti.show()","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+-------+-------+\n| id|   nome|salario|\n+---+-------+-------+\n|  5|Eduardo| 2400.0|\n|  6| Mendes| 1900.0|\n|  7|Kethlyn| 1500.0|\n+---+-------+-------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_left_anti","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635446224006,"submitTime":1635446223992,"finishTime":1635446225043,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Left Anti Join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8ae45add-99be-44dd-8d84-513b66d3b564"},{"version":"CommandV1","origId":3590089513437092,"guid":"1f3e1c46-2381-4642-8d4c-e25ea2edab34","subtype":"command","commandType":"auto","position":10.0,"command":"#retorna todos os elementos do dataframe da esquerda que possuam correspondencia com o dataframe com o dataframe da direita\ndf_left_semi = df1.join(df2, on=['id'], how='left_semi')\ndf_left_semi.display()","commandVersion":56,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,"Andereson",1000.0],[2,"Kennedy",2000.0],[3,"Bruno",2300.0],[4,"Maria",2300.0],[8,"Thiago",1800.0],[9,"Carla",2100.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_left_semi","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635446501434,"submitTime":1635446501419,"finishTime":1635446502523,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"371","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Left Semi Join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0ef77a21-f6b9-4fb9-be60-aeef5677170a"},{"version":"CommandV1","origId":3590089513437093,"guid":"9e629cf0-66e5-4119-9ab1-ae3879db232e","subtype":"command","commandType":"auto","position":11.0,"command":"#RETORNA TODOS OS DADOS DO DATAFRAME DA COLUNA DA ESQUERDA E DA DIREITA\ndf_full = df1.join(df2, on=['id'], how='full')\ndf_full.show()","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+---------+-------+----------+---------+\n| id|     nome|salario|     local|     pais|\n+---+---------+-------+----------+---------+\n|  1|Andereson| 1000.0|     Delhi|    India|\n|  2|  Kennedy| 2000.0|Tamil Nadu|    India|\n|  3|    Bruno| 2300.0|    London|       UK|\n|  4|    Maria| 2300.0|    Sydney|Australia|\n|  5|  Eduardo| 2400.0|      null|     null|\n|  6|   Mendes| 1900.0|      null|     null|\n|  7|  Kethlyn| 1500.0|      null|     null|\n|  8|   Thiago| 1800.0|  New York|      USA|\n|  9|    Carla| 2100.0|California|      USA|\n| 10|     null|   null|New Jersey|      USA|\n| 11|     null|   null|     Texas|      USA|\n| 12|     null|   null|   Chicago|      USA|\n+---+---------+-------+----------+---------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_full","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"},{"metadata":{},"name":"local","nullable":true,"type":"string"},{"metadata":{},"name":"pais","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635446857160,"submitTime":1635446857145,"finishTime":1635446858299,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Full Join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f8a473a2-6710-464e-832a-ba69b8866559"},{"version":"CommandV1","origId":3590089513437094,"guid":"8422cf3d-4e0c-465d-bf87-61b9d81e5ec0","subtype":"command","commandType":"auto","position":12.0,"command":"#retorna todos os elementos do df da esquerda que nao possuem nenhuma correspondnccia com o df da direita\ndf_anti = df1.join(df2, on=['id'], how='anti')\ndf_anti.display()","commandVersion":49,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[5,"Eduardo",2400.0],[6,"Mendes",1900.0],[7,"Kethlyn",1500.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_anti","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635446978156,"submitTime":1635446978134,"finishTime":1635446979306,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"371","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Anti Join","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6c879bf7-7539-4228-8a7a-e3d8c309fa21"},{"version":"CommandV1","origId":3590089513437095,"guid":"60d3d34a-4bf8-4667-9df9-85fd36e8fa9a","subtype":"command","commandType":"auto","position":13.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"567a70e7-34df-47e7-acfb-20fe1f170eb4"}],"dashboards":[],"guid":"a296ce0f-de81-4220-b049-bd80310e184f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}