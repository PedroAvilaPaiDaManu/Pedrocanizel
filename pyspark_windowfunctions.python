{"version":"NotebookV1","origId":2926076408184892,"name":"pyspark_windowfunctions","language":"python","commands":[{"version":"CommandV1","origId":46420859886377,"guid":"18d9d826-ae37-4642-99b0-73a607ffdf20","subtype":"command","commandType":"auto","position":9.0,"command":"(df.withColumn('row', F.row_number().over(w0))\n .withColumn('avg', F.avg(F.col('salario')).over(w0))\n .withColumn('sum', F.sum(F.col('salario')).over(w0))\n .withColumn('min', F.min(F.col('salario')).over(w0))\n .withColumn('max', F.max(F.col('salario')).over(w0))\n .where(F.col('row') > 0).select('row', 'departamento', 'avg', 'sum', 'min', 'max').show()\n\n\n)","commandVersion":110,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+------------+------------------+-------+------+------+\n|row|departamento|               avg|    sum|   min|   max|\n+---+------------+------------------+-------+------+------+\n|  1|    Financas|            1200.0| 1200.0|1200.0|1200.0|\n|  2|    Financas|            2400.0| 4800.0|1200.0|3600.0|\n|  3|    Financas|            3100.0| 9300.0|1200.0|4500.0|\n|  4|    Financas|            4325.0|17300.0|1200.0|8000.0|\n|  1|   Marketing|            1100.0| 1100.0|1100.0|1100.0|\n|  2|   Marketing|            1850.0| 3700.0|1100.0|2600.0|\n|  1|      Vendas|            1100.0| 1100.0|1100.0|1100.0|\n|  2|      Vendas|            1150.0| 2300.0|1100.0|1200.0|\n|  3|      Vendas|1266.6666666666667| 3800.0|1100.0|1500.0|\n+---+------------+------------------+-------+------+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635515520637,"submitTime":1635515520605,"finishTime":1635515522089,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Window Aggregate Functions","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d5e6cc0f-12bf-47b0-b7ee-4db101a75456"},{"version":"CommandV1","origId":46420859886378,"guid":"c38c20e3-ab82-4d74-906e-3e9371702867","subtype":"command","commandType":"auto","position":10.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a83266f9-24a1-42b0-a5e4-9c6c1a8d04c2"},{"version":"CommandV1","origId":2926076408184893,"guid":"095460d3-6f8f-449d-bc74-c940c5560d69","subtype":"command","commandType":"auto","position":1.0,"command":"import pyspark.sql.functions as F\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, FloatType","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635510571943,"submitTime":1635510571922,"finishTime":1635510572001,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cc0fc3b7-741a-4c7f-96b9-b2e2f63deed3"},{"version":"CommandV1","origId":2926076408184894,"guid":"bd275151-f99e-41cd-8333-35e6ccb0542c","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.sql.window import Window","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635510573600,"submitTime":1635510573580,"finishTime":1635510573667,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0ed157c0-aab6-4ed7-a64a-38619c603eaa"},{"version":"CommandV1","origId":2926076408184895,"guid":"16d87a86-b1e9-44e7-9849-f37a7ce6cd3d","subtype":"command","commandType":"auto","position":3.0,"command":"dados = [\n          ('Andereson', 'Vendas', 'SP', 1500.00, 34, 1000.00),\n          ('Kennedy', 'Vendas', 'CE', 1200.00, 56, 2000.00),\n          ('Bruno', 'Vendas', 'SP', 1100.00, 30, 2300.00),\n          ('Maria', 'Financas', 'CE', 3600.00, 24, 2300.00),\n          ('Eduardo', 'Financas', 'CE', 4500.00, 40, 2400.00),\n          ('Mendes', 'Financas', 'RS', 8000.00, 36, 1900.00),\n          ('Kethlyn', 'Financas', 'RS', 1200.00, 53, 1500.00),\n          ('Thiago', 'Marketing', 'GO', 1100.00, 25, 1800.00),\n          ('Carla', 'Marketing', 'GO', 2600.00, 50, 2100.00)\n]\n\nschema = ['nome', 'departamento', 'estado', 'salario', 'idade', 'bonus']\ndf = spark.createDataFrame(data=dados, schema=schema)\ndf.printSchema()\ndf.show()\ndisplay(df)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- nome: string (nullable = true)\n |-- departamento: string (nullable = true)\n |-- estado: string (nullable = true)\n |-- salario: double (nullable = true)\n |-- idade: long (nullable = true)\n |-- bonus: double (nullable = true)\n\n+---------+------------+------+-------+-----+------+\n|     nome|departamento|estado|salario|idade| bonus|\n+---------+------------+------+-------+-----+------+\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|\n+---------+------------+------+-------+-----+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},{"type":"table","data":[["Andereson","Vendas","SP",1500.0,34,1000.0],["Kennedy","Vendas","CE",1200.0,56,2000.0],["Bruno","Vendas","SP",1100.0,30,2300.0],["Maria","Financas","CE",3600.0,24,2300.0],["Eduardo","Financas","CE",4500.0,40,2400.0],["Mendes","Financas","RS",8000.0,36,1900.0],["Kethlyn","Financas","RS",1200.0,53,1500.0],["Thiago","Marketing","GO",1100.0,25,1800.0],["Carla","Marketing","GO",2600.0,50,2100.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"departamento","type":"\"string\"","metadata":"{}"},{"name":"estado","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"},{"name":"idade","type":"\"long\"","metadata":"{}"},{"name":"bonus","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"departamento","nullable":true,"type":"string"},{"metadata":{},"name":"estado","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"},{"metadata":{},"name":"idade","nullable":true,"type":"long"},{"metadata":{},"name":"bonus","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635510105710,"submitTime":1635510105408,"finishTime":1635510113939,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"697","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fa889651-e759-4bf9-a150-a90f46b126b9"},{"version":"CommandV1","origId":2926076408184896,"guid":"620f11a3-97f8-4644-a97e-8b1769e888ea","subtype":"command","commandType":"auto","position":4.0,"command":"#retorna o numero da linha de acordo com a coluna que foi particionada\nw0 = Window.partitionBy(F.col('departamento')).orderBy('salario')\ndf.withColumn('row_number', F.row_number().over(w0)).show()","commandVersion":80,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+------------+------+-------+-----+------+----------+\n|     nome|departamento|estado|salario|idade| bonus|row_number|\n+---------+------------+------+-------+-----+------+----------+\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|         1|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|         2|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|         3|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|         4|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|         1|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|         2|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|         1|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|         2|\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|         3|\n+---------+------------+------+-------+-----+------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635510708309,"submitTime":1635510708282,"finishTime":1635510712329,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"row_number Window Function","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a5ddd7fd-e2db-4d2a-b938-22e578a95835"},{"version":"CommandV1","origId":2926076408184897,"guid":"0a197d2e-ee53-401d-8474-3409e7d0bf34","subtype":"command","commandType":"auto","position":5.0,"command":"df.withColumn('rank', F.rank().over(w0)).show()","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+------------+------+-------+-----+------+----+\n|     nome|departamento|estado|salario|idade| bonus|rank|\n+---------+------------+------+-------+-----+------+----+\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|   1|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|   2|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|   3|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|   4|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|   1|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|   2|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|   1|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|   2|\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|   3|\n+---------+------------+------+-------+-----+------+----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635511244580,"submitTime":1635511244552,"finishTime":1635511246563,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"rank window function","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0f90257a-1d8c-4a88-a867-eddc9507453d"},{"version":"CommandV1","origId":2926076408184898,"guid":"f40ae456-a044-42fe-8250-0a0457157856","subtype":"command","commandType":"auto","position":6.0,"command":"df.withColumn('dense_rank', F.dense_rank().over(w0)).show()","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+------------+------+-------+-----+------+----------+\n|     nome|departamento|estado|salario|idade| bonus|dense_rank|\n+---------+------------+------+-------+-----+------+----------+\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|         1|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|         2|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|         3|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|         4|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|         1|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|         2|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|         1|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|         2|\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|         3|\n+---------+------------+------+-------+-----+------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635512451874,"submitTime":1635512451851,"finishTime":1635512453241,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"dense_rank() Window Function","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f5fb4079-5cb0-4347-b0d8-55f376aabd90"},{"version":"CommandV1","origId":2926076408184899,"guid":"fd3d34f7-7b20-4a3b-b579-c63b1067366b","subtype":"command","commandType":"auto","position":7.0,"command":"df.withColumn('lag', F.lag('salario', 2).over(w0)).show()","commandVersion":20,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+------------+------+-------+-----+------+------+\n|     nome|departamento|estado|salario|idade| bonus|   lag|\n+---------+------------+------+-------+-----+------+------+\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|  null|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|  null|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|1200.0|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|3600.0|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|  null|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|  null|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|  null|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|  null|\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|1100.0|\n+---------+------------+------+-------+-----+------+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635513943814,"submitTime":1635513943650,"finishTime":1635513946019,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"C","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cc90ca0a-2927-43f8-b281-1f4e0ae665d7"},{"version":"CommandV1","origId":4304064361942575,"guid":"02086c4e-efbd-446e-af0a-ea91404f34be","subtype":"command","commandType":"auto","position":8.0,"command":"df.withColumn('lead', F.lead('salario', 2).over(w0)).show()","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+------------+------+-------+-----+------+------+\n|     nome|departamento|estado|salario|idade| bonus|  lead|\n+---------+------------+------+-------+-----+------+------+\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|4500.0|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|8000.0|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|  null|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|  null|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|  null|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|  null|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|1500.0|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|  null|\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|  null|\n+---------+------------+------+-------+-----+------+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635514934525,"submitTime":1635514934497,"finishTime":1635514936191,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"lead window function","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"def2b635-9654-4500-94a9-1d99a357dd52"}],"dashboards":[],"guid":"7261c1b5-c8b5-4245-8124-d74cf0bb5bef","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}