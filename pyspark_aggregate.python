{"version":"NotebookV1","origId":2708467603873616,"name":"pyspark_aggregate","language":"python","commands":[{"version":"CommandV1","origId":2708467603873617,"guid":"7836cd93-9902-40af-a6a2-7f5362127459","subtype":"command","commandType":"auto","position":1.0,"command":"import pyspark.sql.functions as F\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, FloatType\nfrom pyspark.sql.functions import sum","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635953571454,"submitTime":1635953255579,"finishTime":1635953571798,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"84d10641-0b0e-4714-8a0b-f98d628319c7"},{"version":"CommandV1","origId":2708467603873618,"guid":"7e63d1f2-b74c-47ae-b0f9-40545c2d2123","subtype":"command","commandType":"auto","position":2.0,"command":"dados = [\n          ('Andereson', 'Vendas', 'SP', 1500.00, 34, 1000.00),\n          ('Kennedy', 'Vendas', 'CE', 1200.00, 56, 2000.00),\n          ('Bruno', 'Vendas', 'SP', 1100.00, 30, 2300.00),\n          ('Maria', 'Financas', 'CE', 3600.00, 24, 2300.00),\n          ('Eduardo', 'Financas', 'CE', 4500.00, 40, 2400.00),\n          ('Mendes', 'Financas', 'RS', 8000.00, 36, 1900.00),\n          ('Kethlyn', 'Financas', 'RS', 1200.00, 53, 1500.00),\n          ('Thiago', 'Marketing', 'GO', 1100.00, 25, 1800.00),\n          ('Carla', 'Marketing', 'GO', 2600.00, 50, 2100.00)\n]\n\nschema = ['nome', 'departamento', 'estado', 'salario', 'idade', 'bonus']\ndf = spark.createDataFrame(data=dados, schema=schema)\ndf.printSchema()\ndf.show()\ndisplay(df)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- nome: string (nullable = true)\n |-- departamento: string (nullable = true)\n |-- estado: string (nullable = true)\n |-- salario: double (nullable = true)\n |-- idade: long (nullable = true)\n |-- bonus: double (nullable = true)\n\n+---------+------------+------+-------+-----+------+\n|     nome|departamento|estado|salario|idade| bonus|\n+---------+------------+------+-------+-----+------+\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|\n+---------+------------+------+-------+-----+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},{"type":"table","data":[["Andereson","Vendas","SP",1500.0,34,1000.0],["Kennedy","Vendas","CE",1200.0,56,2000.0],["Bruno","Vendas","SP",1100.0,30,2300.0],["Maria","Financas","CE",3600.0,24,2300.0],["Eduardo","Financas","CE",4500.0,40,2400.0],["Mendes","Financas","RS",8000.0,36,1900.0],["Kethlyn","Financas","RS",1200.0,53,1500.0],["Thiago","Marketing","GO",1100.0,25,1800.0],["Carla","Marketing","GO",2600.0,50,2100.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"departamento","type":"\"string\"","metadata":"{}"},{"name":"estado","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"},{"name":"idade","type":"\"long\"","metadata":"{}"},{"name":"bonus","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"departamento","nullable":true,"type":"string"},{"metadata":{},"name":"estado","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"},{"metadata":{},"name":"idade","nullable":true,"type":"long"},{"metadata":{},"name":"bonus","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635438779401,"submitTime":1635438779382,"finishTime":1635438780196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"697","height":"344.986","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"add9324d-9ea4-49a7-890c-491cc8986db8"},{"version":"CommandV1","origId":2708467603873619,"guid":"9aa63f8e-164d-4887-abfa-f192e243f274","subtype":"command","commandType":"auto","position":3.0,"command":"%md\naproxx_count_distinct Aggregate Funcion\n\nExibeos valores distintos em um gtupo dentro de um dataframe(nesse caso o grupo Ã© o salario)","commandVersion":43,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cec95873-0a26-48c8-9944-d05c86b363ca"},{"version":"CommandV1","origId":2708467603873620,"guid":"551971b2-81c4-4ff6-a016-44c57abb36be","subtype":"command","commandType":"auto","position":4.0,"command":"approx = df.select(F.approx_count_distinct('salario')).collect()[0][0]\nprint(f'approx_count_distinct: {approx}')","commandVersion":48,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">approx_count_distinct: 7\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635439142596,"submitTime":1635439142582,"finishTime":1635439143613,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"78a90392-faa7-41d3-9f32-25740d22f534"},{"version":"CommandV1","origId":2708467603873621,"guid":"37ef88ff-2991-4b73-96a0-ce84b1c84d03","subtype":"command","commandType":"auto","position":5.0,"command":"%md\nAVG Aggregate Function","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c7736461-cf31-4aa2-902a-4f78f4127db0"},{"version":"CommandV1","origId":2708467603873622,"guid":"b235b5f3-0914-4d54-9317-6290f815c8b3","subtype":"command","commandType":"auto","position":6.0,"command":"#retorna a media de valores atraves da coluna salario\navg = df.select(F.avg('salario')).collect()[0][0]\nprint(f'svg: {avg:.2f}')","commandVersion":44,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">svg: 2755.56\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635439543643,"submitTime":1635439543630,"finishTime":1635439543982,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5f2ce634-de33-4ce2-81ba-04bf8b2aadcc"},{"version":"CommandV1","origId":2708467603873623,"guid":"77e9a84d-82bb-408f-8c58-7baf886f48ae","subtype":"command","commandType":"auto","position":7.0,"command":"%md\ncollect_list Aggregation Function","commandVersion":11,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"06f5dc1a-af8e-44a3-a486-dc3ea19aee9a"},{"version":"CommandV1","origId":2708467603873624,"guid":"90737dd8-4531-444d-996b-7e1efdc3f69c","subtype":"command","commandType":"auto","position":8.0,"command":"#pega todos os salarios e coloca dentro de uma lista\ndf.select(F.collect_list('salario')).show(truncate=False)","commandVersion":34,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------------------------------------------------------------------+\n|collect_list(salario)                                                   |\n+------------------------------------------------------------------------+\n|[1500.0, 1200.0, 1100.0, 3600.0, 4500.0, 8000.0, 1200.0, 1100.0, 2600.0]|\n+------------------------------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635439744997,"submitTime":1635439744983,"finishTime":1635439745491,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"410","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"17551eb5-c2a9-453a-8a68-8788dd56529d"},{"version":"CommandV1","origId":2708467603873625,"guid":"329e9e9d-e1b5-4aa7-95e3-04a5f0ecd1e3","subtype":"command","commandType":"auto","position":9.0,"command":"%md\ncollect_set Aggregation Function","commandVersion":13,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0673b6af-7f91-4d2d-a214-4f99f6d42ebd"},{"version":"CommandV1","origId":2708467603873626,"guid":"ee10e0ab-0a19-4806-b1c5-e973577d0ad7","subtype":"command","commandType":"auto","position":10.0,"command":"#retorna uma lisa de valores distintos (salario)\ndf.select(F.collect_set('salario')).show(truncate=False)","commandVersion":28,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------------------------------------------+\n|collect_set(salario)                                    |\n+--------------------------------------------------------+\n|[3600.0, 8000.0, 1500.0, 1100.0, 4500.0, 1200.0, 2600.0]|\n+--------------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635439962793,"submitTime":1635439962779,"finishTime":1635439963737,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1a9abbec-e09e-49da-9f44-89ce6818b985"},{"version":"CommandV1","origId":2708467603873627,"guid":"28a1fdd9-00c8-4915-b874-5816a96a9b6c","subtype":"command","commandType":"auto","position":11.0,"command":"df2 = df.select(F.collect_set('salario'))\ndf2.show(truncate=False)","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------------------------------------------+\n|collect_set(salario)                                    |\n+--------------------------------------------------------+\n|[3600.0, 8000.0, 1500.0, 1100.0, 4500.0, 1200.0, 2600.0]|\n+--------------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df2","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"collect_set(salario)","nullable":false,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635440228591,"submitTime":1635440228576,"finishTime":1635440229124,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"077de3e4-bbbd-4ba9-adaf-5f22cf6fff2a"},{"version":"CommandV1","origId":2708467603873628,"guid":"52a790a5-1ebb-409c-867f-3d20653bda31","subtype":"command","commandType":"auto","position":12.0,"command":"%md\nCountDistinct Aggregate Function\n","commandVersion":18,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"deddfd80-a4ce-4f7c-87bf-45f54ee5e118"},{"version":"CommandV1","origId":2708467603873629,"guid":"f622d7d5-b8bf-4909-97a8-1242c91d1e22","subtype":"command","commandType":"auto","position":13.0,"command":"#retorna o numero de elementos distintos\ndf2 = df.select(F.countDistinct(F.col('departamento'), F.col('salario')))\ndf2.show(truncate=False)\ndf.show(truncate=False)","commandVersion":43,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------------------------+\n|count(DISTINCT departamento, salario)|\n+-------------------------------------+\n|9                                    |\n+-------------------------------------+\n\n+---------+------------+------+-------+-----+------+\n|nome     |departamento|estado|salario|idade|bonus |\n+---------+------------+------+-------+-----+------+\n|Andereson|Vendas      |SP    |1500.0 |34   |1000.0|\n|Kennedy  |Vendas      |CE    |1200.0 |56   |2000.0|\n|Bruno    |Vendas      |SP    |1100.0 |30   |2300.0|\n|Maria    |Financas    |CE    |3600.0 |24   |2300.0|\n|Eduardo  |Financas    |CE    |4500.0 |40   |2400.0|\n|Mendes   |Financas    |RS    |8000.0 |36   |1900.0|\n|Kethlyn  |Financas    |RS    |1200.0 |53   |1500.0|\n|Thiago   |Marketing   |GO    |1100.0 |25   |1800.0|\n|Carla    |Marketing   |GO    |2600.0 |50   |2100.0|\n+---------+------------+------+-------+-----+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df2","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"count(DISTINCT departamento, salario)","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635440536390,"submitTime":1635440536377,"finishTime":1635440537540,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ff37d7a0-f9bd-4395-9f09-2c97292556c4"},{"version":"CommandV1","origId":2708467603873630,"guid":"a6e3830d-c100-4294-a67d-90df4f2e9d90","subtype":"command","commandType":"auto","position":14.0,"command":"%md\nFirst Function","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"493e8f35-43bf-4491-8f0b-03f5a9681a39"},{"version":"CommandV1","origId":2708467603873631,"guid":"c9abc418-cf39-4a25-9bcd-6cb84565c5f8","subtype":"command","commandType":"auto","position":15.0,"command":"#retorna o primeiro valor\ndf.select(F.first('salario')).show(truncate=False)","commandVersion":20,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------+\n|first(salario)|\n+--------------+\n|1500.0        |\n+--------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635441278828,"submitTime":1635441278815,"finishTime":1635441279545,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a548efb7-7ea5-401a-89c4-065ea88c5603"},{"version":"CommandV1","origId":2708467603873632,"guid":"9bbdee93-aa8b-4f4f-afec-ecb262009f0a","subtype":"command","commandType":"auto","position":16.0,"command":"    %md\n    Max - Min","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"25de84bf-0cf9-43bd-b152-31e7761c0740"},{"version":"CommandV1","origId":2708467603873633,"guid":"5e067def-01fb-446c-9f99-5db8203939a3","subtype":"command","commandType":"auto","position":17.0,"command":"#retorna o maior valor\ndf.select(F.max(F.col('salario'))).show()","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+\n|max(salario)|\n+------------+\n|      8000.0|\n+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635441344615,"submitTime":1635441344602,"finishTime":1635441345333,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"54466dc5-d3df-496b-bb3e-1b6a108c801f"},{"version":"CommandV1","origId":2708467603873634,"guid":"3ca2217c-f410-4034-a518-234e42f38e43","subtype":"command","commandType":"auto","position":18.0,"command":"#retorna o menor valor\ndf.select(F.max(F.col('salario'))).show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+\n|max(salario)|\n+------------+\n|      8000.0|\n+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635441364708,"submitTime":1635441364690,"finishTime":1635441365097,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"63e863b7-811e-4934-9b34-4d5006ebb068"},{"version":"CommandV1","origId":2708467603873635,"guid":"4af3763e-e2e8-408d-a4c0-ca5918471e26","subtype":"command","commandType":"auto","position":19.0,"command":"%md\nSUM()","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"709ff61b-ea5b-4d82-bbe2-2303b0b170e5"},{"version":"CommandV1","origId":2708467603873636,"guid":"c5876c87-3ecf-48ca-aae4-34ebfd28e09f","subtype":"command","commandType":"auto","position":20.0,"command":"#retorna o maior valor\ndf.select(F.sum(F.col('salario'))).show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+\n|sum(salario)|\n+------------+\n|     24800.0|\n+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635441379281,"submitTime":1635441379268,"finishTime":1635441379771,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"93ab5523-2532-41a4-a495-3326668aa2a0"},{"version":"CommandV1","origId":2708467603873637,"guid":"14972739-0cec-4f6d-b1ae-8b8aff73af08","subtype":"command","commandType":"auto","position":21.0,"command":"df.select(F.count('salario')).show(truncate=False)\nvalor =df.select(F.count('salario')).collect()[0][0]\nprint(valor)","commandVersion":31,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------+\n|count(salario)|\n+--------------+\n|9             |\n+--------------+\n\n9\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635441635403,"submitTime":1635441635386,"finishTime":1635441636559,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Collect()[0][0]","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fc8ebdac-73ba-4a5f-938c-64f1d4ec28ee"}],"dashboards":[],"guid":"6f98e0c8-39f3-4962-8051-5b9168ddda59","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}