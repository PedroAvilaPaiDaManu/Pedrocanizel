{"version":"NotebookV1","origId":2967948249501865,"name":"pyspark_groupyby","language":"python","commands":[{"version":"CommandV1","origId":2967948249501866,"guid":"8c5dbbd9-5f0e-43d6-9a6f-7c1c5dabc8d8","subtype":"command","commandType":"auto","position":1.0,"command":"%md\nGroup by() semelhante ao do SQL","commandVersion":23,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Group by()","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2b864a4e-f10e-413b-8b36-f998914faf1a"},{"version":"CommandV1","origId":2967948249501869,"guid":"5f5ba13c-0f31-42cc-bdaf-1615af22ebcc","subtype":"command","commandType":"auto","position":2.0,"command":"dados = [\n          ('Andereson', 'Vendas', 'SP', 1500.00, 34, 1000.00),\n          ('Kennedy', 'Vendas', 'CE', 1200.00, 56, 2000.00),\n          ('Bruno', 'Vendas', 'SP', 1100.00, 30, 2300.00),\n          ('Maria', 'Financas', 'CE', 3600.00, 24, 2300.00),\n          ('Eduardo', 'Financas', 'CE', 4500.00, 40, 2400.00),\n          ('Mendes', 'Financas', 'RS', 8000.00, 36, 1900.00),\n          ('Kethlyn', 'Financas', 'RS', 1200.00, 53, 1500.00),\n          ('Thiago', 'Marketing', 'GO', 1100.00, 25, 1800.00),\n          ('Carla', 'Marketing', 'GO', 2600.00, 50, 2100.00)\n]\n\nschema = ['nome', 'departamento', 'estado', 'salario', 'idade', 'bonus']\ndf = spark.createDataFrame(data=dados, schema=schema)\ndf.printSchema()\ndf.show()\ndisplay(df)","commandVersion":45,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- nome: string (nullable = true)\n |-- departamento: string (nullable = true)\n |-- estado: string (nullable = true)\n |-- salario: double (nullable = true)\n |-- idade: long (nullable = true)\n |-- bonus: double (nullable = true)\n\n+---------+------------+------+-------+-----+------+\n|     nome|departamento|estado|salario|idade| bonus|\n+---------+------------+------+-------+-----+------+\n|Andereson|      Vendas|    SP| 1500.0|   34|1000.0|\n|  Kennedy|      Vendas|    CE| 1200.0|   56|2000.0|\n|    Bruno|      Vendas|    SP| 1100.0|   30|2300.0|\n|    Maria|    Financas|    CE| 3600.0|   24|2300.0|\n|  Eduardo|    Financas|    CE| 4500.0|   40|2400.0|\n|   Mendes|    Financas|    RS| 8000.0|   36|1900.0|\n|  Kethlyn|    Financas|    RS| 1200.0|   53|1500.0|\n|   Thiago|   Marketing|    GO| 1100.0|   25|1800.0|\n|    Carla|   Marketing|    GO| 2600.0|   50|2100.0|\n+---------+------------+------+-------+-----+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},{"type":"table","data":[["Andereson","Vendas","SP",1500.0,34,1000.0],["Kennedy","Vendas","CE",1200.0,56,2000.0],["Bruno","Vendas","SP",1100.0,30,2300.0],["Maria","Financas","CE",3600.0,24,2300.0],["Eduardo","Financas","CE",4500.0,40,2400.0],["Mendes","Financas","RS",8000.0,36,1900.0],["Kethlyn","Financas","RS",1200.0,53,1500.0],["Thiago","Marketing","GO",1100.0,25,1800.0],["Carla","Marketing","GO",2600.0,50,2100.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"nome","type":"\"string\"","metadata":"{}"},{"name":"departamento","type":"\"string\"","metadata":"{}"},{"name":"estado","type":"\"string\"","metadata":"{}"},{"name":"salario","type":"\"double\"","metadata":"{}"},{"name":"idade","type":"\"long\"","metadata":"{}"},{"name":"bonus","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"nome","nullable":true,"type":"string"},{"metadata":{},"name":"departamento","nullable":true,"type":"string"},{"metadata":{},"name":"estado","nullable":true,"type":"string"},{"metadata":{},"name":"salario","nullable":true,"type":"double"},{"metadata":{},"name":"idade","nullable":true,"type":"long"},{"metadata":{},"name":"bonus","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635438784711,"submitTime":1635438784614,"finishTime":1635438786426,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"697","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1f42e9c8-e045-4e2a-ab7e-3abcbb31ee23"},{"version":"CommandV1","origId":2967948249501871,"guid":"69753dfa-9783-4d43-a8bf-4449041af057","subtype":"command","commandType":"auto","position":3.0,"command":"df.groupBy(F.col('departamento')).count().display()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["Vendas",3],["Financas",4],["Marketing",1],["MArketing",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"departamento","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431267215,"submitTime":1635431267190,"finishTime":1635431270411,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"297","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c5a5a430-e8c4-4a3d-b782-c3f845951430"},{"version":"CommandV1","origId":2967948249501876,"guid":"ad79e574-94f9-4b3d-9f79-355bc21b7624","subtype":"command","commandType":"auto","position":1.5,"command":"import pyspark.sql.functions as F\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, FloatType","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431007192,"submitTime":1635430994370,"finishTime":1635431007507,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bdb7b936-fd3e-4dbf-9531-fabe7ae8f25f"},{"version":"CommandV1","origId":2967948249501879,"guid":"1118ddda-2191-4df9-a0fd-627f5b21be8b","subtype":"command","commandType":"auto","position":4.0,"command":"df.groupBy(F.col('departamento')).sum('salario').show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+------------+\n|departamento|sum(salario)|\n+------------+------------+\n|      Vendas|      3800.0|\n|    Financas|     17300.0|\n|   Marketing|      1100.0|\n|   MArketing|      2600.0|\n+------------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431324307,"submitTime":1635431324291,"finishTime":1635431325806,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fa63a376-0623-459b-8038-ae7c43475950"},{"version":"CommandV1","origId":2967948249501880,"guid":"f9230d05-cab4-47fc-a957-a9974ed0a1fd","subtype":"command","commandType":"auto","position":5.0,"command":"df.groupBy(F.col('departamento')).min('salario').show()","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+------------+\n|departamento|min(salario)|\n+------------+------------+\n|      Vendas|      1100.0|\n|    Financas|      1200.0|\n|   Marketing|      1100.0|\n|   MArketing|      2600.0|\n+------------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431374106,"submitTime":1635431374086,"finishTime":1635431375373,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c538f2e8-6cf8-4a2d-9b59-76c9019a249e"},{"version":"CommandV1","origId":2967948249501881,"guid":"d3199f7d-6c0e-4649-abac-617b155992c7","subtype":"command","commandType":"auto","position":6.0,"command":"df.groupBy(F.col('departamento')).max('salario').show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+------------+\n|departamento|max(salario)|\n+------------+------------+\n|      Vendas|      1500.0|\n|    Financas|      8000.0|\n|   Marketing|      1100.0|\n|   MArketing|      2600.0|\n+------------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431384267,"submitTime":1635431384248,"finishTime":1635431385665,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"42e24c4f-7179-43ef-97b0-42f611f39bc9"},{"version":"CommandV1","origId":2967948249501882,"guid":"cabe03e5-8078-4858-9885-4a473bcf0e90","subtype":"command","commandType":"auto","position":7.0,"command":"df.groupBy(F.col('departamento')).mean('salario').show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+------------------+\n|departamento|      avg(salario)|\n+------------+------------------+\n|      Vendas|1266.6666666666667|\n|    Financas|            4325.0|\n|   Marketing|            1100.0|\n|   MArketing|            2600.0|\n+------------+------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431399322,"submitTime":1635431399307,"finishTime":1635431400481,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"62ffefa2-3099-48c2-bec1-a7d1326b755b"},{"version":"CommandV1","origId":2967948249501883,"guid":"0a0a97a0-cb78-46e4-bb66-ca051313af53","subtype":"command","commandType":"auto","position":6.5,"command":"%md\nmean() - retorna a media ","commandVersion":35,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e69c718b-652c-4705-aaaa-b3f23cafc7ba"},{"version":"CommandV1","origId":2967948249501884,"guid":"869cb468-3f5e-487d-91bc-a6bd701ed667","subtype":"command","commandType":"auto","position":9.0,"command":"%md\navg() media","commandVersion":5,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"545c4448-c168-4337-b7bc-528feef500c0"},{"version":"CommandV1","origId":2967948249501885,"guid":"40515c62-e21f-44dc-9f9d-59aaa08d6009","subtype":"command","commandType":"auto","position":3.5,"command":"%md\n#sum() - mostrar a soma dos salarios por departamento","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"86392ba4-25dc-44f1-b19d-b13c6a038fc0"},{"version":"CommandV1","origId":2967948249501886,"guid":"c70f1d0b-3a30-40de-bcb1-cd189a1223f9","subtype":"command","commandType":"auto","position":4.5,"command":"%md\nmin() mostra o menor salario por departamentp","commandVersion":17,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ad35b233-4134-4fc2-a044-8035bae8385f"},{"version":"CommandV1","origId":2967948249501887,"guid":"9ece25c1-e5a2-4033-856f-7be09c7e5c4c","subtype":"command","commandType":"auto","position":5.5,"command":"%md\nmax() mostra o maior salario por departamentp","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9e8359ea-82d4-4710-b7c2-c561d52f8748"},{"version":"CommandV1","origId":2967948249501888,"guid":"7dc419b0-ea12-45b3-990c-38a9014a561f","subtype":"command","commandType":"auto","position":10.0,"command":"df.groupBy(F.col('departamento')).avg('salario').show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+------------------+\n|departamento|      avg(salario)|\n+------------+------------------+\n|      Vendas|1266.6666666666667|\n|    Financas|            4325.0|\n|   Marketing|            1100.0|\n|   MArketing|            2600.0|\n+------------+------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431640368,"submitTime":1635431640352,"finishTime":1635431641179,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d2c7dc89-ad89-4661-8d03-6c6c6416b0a1"},{"version":"CommandV1","origId":2967948249501889,"guid":"3312fcb4-ee48-4394-bcdf-d07f3916fcbe","subtype":"command","commandType":"auto","position":11.0,"command":"%md\ngroup by () com multiplas colunas","commandVersion":9,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d67064fc-935a-44a8-a164-2bb0f4d35b58"},{"version":"CommandV1","origId":2967948249501890,"guid":"edb72058-ff53-401b-b742-37572afb42d8","subtype":"command","commandType":"auto","position":12.0,"command":"df.groupBy(F.col('departamento'), F.col('estado')).sum('salario', 'bonus').show()","commandVersion":27,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+------+------------+----------+\n|departamento|estado|sum(salario)|sum(bonus)|\n+------------+------+------------+----------+\n|      Vendas|    SP|      2600.0|    3300.0|\n|      Vendas|    CE|      1200.0|    2000.0|\n|    Financas|    CE|      8100.0|    4700.0|\n|    Financas|    RS|      9200.0|    3400.0|\n|   Marketing|    GO|      1100.0|    1800.0|\n|   MArketing|    GO|      2600.0|    2100.0|\n+------------+------+------------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431884892,"submitTime":1635431884877,"finishTime":1635431886489,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"02f02175-127f-4950-8a92-7fb786ca9d6b"},{"version":"CommandV1","origId":2967948249501891,"guid":"abd659b0-0ddf-4608-86fb-ab3b81b0dd4e","subtype":"command","commandType":"auto","position":13.0,"command":"from pyspark.sql.functions import sum\ndf.groupBy(\"departamento\").agg(sum(\"salario\").alias(\"soma_salario\")).show()\n","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------------+------------+\n|departamento|soma_salario|\n+------------+------------+\n|      Vendas|      3800.0|\n|    Financas|     17300.0|\n|   Marketing|      1100.0|\n|   MArketing|      2600.0|\n+------------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635431968491,"submitTime":1635431968476,"finishTime":1635431969350,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fbc213a3-6af1-4076-86bd-c9696f806bea"},{"version":"CommandV1","origId":2967948249501892,"guid":"06085932-3398-4c8d-8508-3f49ba9e3a80","subtype":"command","commandType":"auto","position":14.0,"command":"%md\nFiltrando DataFrame Agrupado","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"371682fd-b669-4919-a3c1-a949e45311f1"},{"version":"CommandV1","origId":2967948249501894,"guid":"0804d914-6ed7-4788-890d-806a3215437a","subtype":"command","commandType":"auto","position":12.5,"command":"%md\nAGG() - permite agregar mais de uma função","commandVersion":11,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bad5f32c-6c40-4a94-a36b-a5b2ecde5a71"},{"version":"CommandV1","origId":2967948249501895,"guid":"a3a5a7da-48f5-4f92-8c67-7d0cd2b85142","subtype":"command","commandType":"auto","position":12.75,"command":"(df.groupBy(F.col(\"departamento\")).agg(\n            F.sum(\"salario\").alias(\"soma_salario\"),\n            F.mean(\"salario\").alias(\"media_salario\"),\n            F.avg(\"salario\").alias(\"media2_salario\"),\n            F.sum(\"bonus\").alias(\"soma_bonus\"),\n            F.max(\"bonus\").alias(\"maior_bonus\"),\n            F.min(\"bonus\").alias(\"menor_bonus\")\n            ).display()\n)","commandVersion":111,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["Vendas",3800.0,1266.6666666666667,1266.6666666666667,5300.0,2300.0,1000.0],["Financas",17300.0,4325.0,4325.0,8100.0,2400.0,1500.0],["Marketing",1100.0,1100.0,1100.0,1800.0,1800.0,1800.0],["MArketing",2600.0,2600.0,2600.0,2100.0,2100.0,2100.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"departamento","type":"\"string\"","metadata":"{}"},{"name":"soma_salario","type":"\"double\"","metadata":"{}"},{"name":"media_salario","type":"\"double\"","metadata":"{}"},{"name":"media2_salario","type":"\"double\"","metadata":"{}"},{"name":"soma_bonus","type":"\"double\"","metadata":"{}"},{"name":"maior_bonus","type":"\"double\"","metadata":"{}"},{"name":"menor_bonus","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635432402677,"submitTime":1635432402660,"finishTime":1635432404341,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"985","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"adc55000-8003-441e-b856-30000c5e1d3d"},{"version":"CommandV1","origId":2967948249501896,"guid":"1e0901e7-c229-44b0-9fe0-e565aa125e91","subtype":"command","commandType":"auto","position":15.0,"command":"(df.groupBy(F.col(\"departamento\")).agg(\n            F.sum(\"salario\").alias(\"soma_salario\"),\n            F.mean(\"salario\").alias(\"media_salario\"),\n            F.avg(\"salario\").alias(\"media2_salario\"),\n            F.sum(\"bonus\").alias(\"soma_bonus\"),\n            F.max(\"bonus\").alias(\"maior_bonus\"),\n            F.min(\"bonus\").alias(\"menor_bonus\")\n            ).where(F.col('soma_salario') >= 3800).display()\n)","commandVersion":53,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["Vendas",3800.0,1266.6666666666667,1266.6666666666667,5300.0,2300.0,1000.0],["Financas",17300.0,4325.0,4325.0,8100.0,2400.0,1500.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"departamento","type":"\"string\"","metadata":"{}"},{"name":"soma_salario","type":"\"double\"","metadata":"{}"},{"name":"media_salario","type":"\"double\"","metadata":"{}"},{"name":"media2_salario","type":"\"double\"","metadata":"{}"},{"name":"soma_bonus","type":"\"double\"","metadata":"{}"},{"name":"maior_bonus","type":"\"double\"","metadata":"{}"},{"name":"menor_bonus","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1635433170119,"submitTime":1635433170103,"finishTime":1635433170866,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"985","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e18ef89a-7cea-479e-b662-f04c72492d7c"},{"version":"CommandV1","origId":2967948249501897,"guid":"f6267344-9ee3-4bb4-aee8-0da886ec4ce0","subtype":"command","commandType":"auto","position":16.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ca937c47-2dac-4b6d-a598-364bac7cff3a"}],"dashboards":[],"guid":"7e94a62e-4eb7-4e21-8ea2-da737a9b5c9b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}